# Управление планами

> **Этот файл является источником истины для управления планами.** ИИ-агенты обязаны следовать этим инструкциям при создании, перемещении или изменении планов.

## Конфигурация

**Трекер задач:** none
<!-- Варианты: GitHub | GitLab | none -->
<!-- Для активации: измените на "GitHub" или "GitLab" и настройте репозиторий -->

**Репозиторий:** `user/repo-name`

## Формат имени файла

```
TYPE-YYYY-MM-DD-NNNN-description.md
```

| Сегмент | Описание | Пример |
|---------|----------|--------|
| `TYPE` | Статус: `BACKLOG`, `CODING`, `DONE`, `DRAFT` | `BACKLOG` |
| `YYYY-MM-DD` | Дата перехода в текущий статус | `2026-01-15` |
| `NNNN` | Внутренний последовательный ID, 4 цифры с ведущими нулями | `0001` |
| `description` | Краткое название в kebab-case | `user-auth-setup` |

### Внутренний ID (`NNNN`)

Инкрементальный счётчик, специфичный для проекта. Чтобы получить следующий:

1. Найдите наибольший `NNNN` среди всех подпапок (`backlog/`, `coding/`, `done/`)
2. Прибавьте 1

ID является **постоянным** — он не меняется, даже если изменится статус или название плана.

> **Зарезервировано:** ID `0000` зарезервирован для файлов-примеров/шаблонов. Первый реальный план должен использовать `0001`.

### Правило даты

Дата в имени файла отражает момент перехода в текущий статус:

| Статус | Дата в имени = |
|--------|----------------|
| BACKLOG | Дата создания плана |
| CODING | Дата начала работы |
| DONE | Дата завершения |

## Структура папок

```
workplan/
├── README.md          # Этот файл (источник истины)
├── backlog/           # Ожидающие планы
├── coding/            # В процессе разработки
├── done/              # Завершённые планы (архив)
└── draft/             # Черновики, идеи и решения (без процесса смены статуса)
```

## Стандартизированный заголовок

```markdown
# План: Описательное название

**Статус:** Backlog | Coding | Done
**Backlog:** 2026-01-15
**Coding:** —
**Done:** —
**Область:** general
**Issue:** —
```

**Правила заголовка:**
- Статус должен соответствовать префиксу имени файла
- Даты фиксируют момент каждого перехода (`—`, если не применимо)
- **Issue** — `—`, если трекер задач настроен как «none»

## Стандартный шаблон

### Обязательная терминология

| Термин | Использование | Пример |
|--------|---------------|--------|
| **Фаза** | Крупная веха реализации | Фаза 1: MVP, Фаза 2: Улучшения |
| **Шаг** | Конкретный пункт в чек-листе прогресса | `- [ ] Создать SQL-миграцию` |

### Порядок разделов

Заголовок → Прогресс → Цель → Контекст → Реализация → Проверка → Риски

Необязательные разделы **опускаются**, а не оставляются пустыми.

### Шаблон

```markdown
# План: Описательное название

**Статус:** Backlog
**Backlog:** YYYY-MM-DD
**Coding:** —
**Done:** —
**Область:** general
**Issue:** —

## Прогресс

### Фаза 1: MVP
- [ ] Конкретный, проверяемый шаг
- [ ] Ещё один шаг

### Фаза 2: Улучшения *(если применимо)*
- [ ] Конкретный, проверяемый шаг

## Цель

Чего нужно достичь и почему (1–3 абзаца).

## Контекст *(необязательно)*

Текущее состояние, предпосылки.

## Реализация

### Фаза 1: MVP

Техническое описание реализации.

### Фаза 2: Улучшения *(необязательно)*

## Проверка *(необязательно)*

Шаги для подтверждения корректного выполнения плана.

## Риски *(необязательно)*

Только для сложных планов.
```

### Правила

1. **Прогресс всегда после заголовка**, никогда не в конце
2. Шаги группируются по фазам (`### Фаза N: Название`)
3. Каждый шаг должен быть конкретным и проверяемым (не общим)
4. Техническая детализация в Реализации, краткое изложение в Прогрессе
5. Только «Фаза» и «Шаг», никогда «Этап»
6. Необязательные разделы опускаются, а не оставляются пустыми

## Процесс

### Создание плана

1. Получите следующий последовательный ID (`NNNN`)
2. Создайте файл в `backlog/BACKLOG-YYYY-MM-DD-NNNN-description.md`

### Начало работы

1. Переместите из `backlog/` в `coding/CODING-YYYY-MM-DD-NNNN-description.md` (дата = сегодня, ID не меняется)
2. Обновите заголовок: `Статус: Coding`, `Coding: YYYY-MM-DD`

### Завершение

1. Переместите из `coding/` в `done/DONE-YYYY-MM-DD-NNNN-description.md` (дата = сегодня)
2. Обновите заголовок: `Статус: Done`, `Done: YYYY-MM-DD`

### Возврат в backlog

1. Переместите из `coding/` в `backlog/BACKLOG-YYYY-MM-DD-NNNN-description.md`
2. Обновите заголовок: `Статус: Backlog`

## Перекрёстные ссылки

Планы ссылаются друг на друга по **внутреннему ID** (`NNNN`), который является постоянным:

```markdown
**Зависимости:** План 0001, План 0002

Подробности см. в плане 0003.
```

**Правило:** никогда не ссылайтесь на план по полному имени файла (оно меняется при каждом переходе). Всегда используйте внутренний ID.

## Получение следующего ID

```bash
# Найти наибольший NNNN среди всех подпапок
ls workplan/{backlog,coding,done}/ | grep -oP '\d{4}' | sort -n | tail -1
# Прибавить 1 к результату
```

## Черновики

Черновики хранятся в `draft/` с форматом `DRAFT-YYYY-MM-DD-description.md`. Они не следуют процессу BACKLOG→CODING→DONE и не имеют последовательного ID. Они служат банком идей: наброски планов, технические решения, исследовательские заметки. Когда черновик достаточно созревает, он продвигается в `backlog/` как формальный план.
